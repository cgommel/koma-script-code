% ======================================================================
% scrbookreportarticle-experts.tex
% Copyright (c) Markus Kohm, 2001-2012
%
% This file is part of the LaTeX2e KOMA-Script bundle.
%
% This work may be distributed and/or modified under the conditions of
% the LaTeX Project Public License, version 1.3c of the license.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3c or later is part of all distributions of LaTeX 
% version 2005/12/01 or later and of this work.
%
% This work has the LPPL maintenance status "author-maintained".
%
% The Current Maintainer and author of this work is Markus Kohm.
%
% This work consists of all files listed in manifest.txt.
% ----------------------------------------------------------------------
% scrbookreportarticle-experts.tex
% Copyright (c) Markus Kohm, 2001-2012
%
% Dieses Werk darf nach den Bedingungen der LaTeX Project Public Lizenz,
% Version 1.3c, verteilt und/oder veraendert werden.
% Die neuste Version dieser Lizenz ist
%   http://www.latex-project.org/lppl.txt
% und Version 1.3c ist Teil aller Verteilungen von LaTeX
% Version 2005/12/01 oder spaeter und dieses Werks.
%
% Dieses Werk hat den LPPL-Verwaltungs-Status "author-maintained"
% (allein durch den Autor verwaltet).
%
% Der Aktuelle Verwalter und Autor dieses Werkes ist Markus Kohm.
% 
% Dieses Werk besteht aus den in manifest.txt aufgefuehrten Dateien.
% ======================================================================
%
% Chapter about scrbook, scrreprt, and scrartcl of the KOMA-Script guide
% expert part
% Maintained by Markus Kohm
%
% ----------------------------------------------------------------------
%
% Kapitel ueber scrbook, scrreprt und scrartcl im Experten-Teil der
% KOMA-Script-Anleitung
% Verwaltet von Markus Kohm
%
% ============================================================================

\ProvidesFile{scrbookreportarticle-experts.tex}[2012/02/01 KOMA-Script guide
(chapter: scrbook, scrreprt, scrartcl for experts)]

\translator{Gernot Hassenpflug\and Markus Kohm}

% Date of the translated German file: 0000/00/00


\chapter{Additional Information about the Main Classes \Class{scrbook},
  \Class{scrreprt}, and \Class{scrartcl} as well as the Package
  \Package{scrextend}\protect\footnote{Translation of this chapter is still
    missing or incomplete. Instead of the translations of the original chapter
    from the German manual you may find here outdated information from the old
    English manual without any structure. Translators from German to English
    would be welcome!}}
\labelbase{maincls-experts}

This chapter gives additional information about the \KOMAScript{} classes
\Class{scrbook}, \Class{scrreprt}, and \Class{scrartcl}. Some of the features
are also available for package \Package{scrextend}. \iffree{Some parts of the
  chapter are subject to the \KOMAScript{} book \cite{book:komascript}
  only. This shouldn't be a problem, because the}{The} average user, who only
want to use the package, won't need the information, that is addressed to
users with non-standard requirements or who want to write their own classes
using a \KOMAScript{} class. Another part of the information describes features
of the classes that exist only because of compatibility to former
releases of \KOMAScript{} or the standard classes. The features, that exist
only because of compatibility to former \KOMAScript{} releases, are printed
with a sans serif font. You shouldn't use them any longer.

\LoadNonFree{scrbookreportarticle-experts}{0}

\section{Additional Information to User Commands}
\label{sec:maincls-experts.addInfos}

\LoadNonFree{scrbookreportarticle-experts}{1}


\section{Cooperation and Coexistence of \KOMAScript{} and Other Packages}
\label{sec:maincls-experts.coexistence}

\LoadNonFree{scrbookreportarticle-experts}{2}


\section{Expert Commands\protect\footnote{Translation of this section is
    still missing or incomplete. Translators from German to English would be
    welcome!}}
\label{sec:maincls-experts.experts}

This sections described commands, that are more or less out of average user's
interest. Nevertheless these commands provide additional features for
experts. Because the information is addressed to experts it's condensed.


\begin{Declaration}
  \Macro{KOMAClassName}\\
  \Macro{ClassName}
\end{Declaration}
\BeginIndex{Cmd}{KOMAClassName}%
\BeginIndex{Cmd}{ClassName}%
\Macro{KOMAClassName} stores the name of the currently used \KOMAScript{}
class. If someone wants to know, whether or not or a \KOMAScript{} class is
used or which \KOMAScript{} is used this may be tested with this command. In
difference to this, \Macro{ClassName} tells which would be the standard class,
that has been replaced by a \KOMAScript{} class.

Please note\textnote{Attention!}, that the existence of
\Macro{KOMAScript}\IndexCmd{KOMAScript} isn't a indication for the usage of a
\KOMAScript{} class. First of all: Every \KOMAScript{} package and not only
\KOMAScript{} classes define \Macro{KOMAScript}. Furthermore other packages
may also define the \KOMAScript{} word mark with this name.%
% 
\EndIndex{Cmd}{ClassName}%
\EndIndex{Cmd}{KOMAClassName}%

\begin{Declaration}
  \Macro{addtocentrydefault}\Parameter{level}\Parameter{number}%
  \Parameter{heading}
\end{Declaration}
\BeginIndex{Cmd}{addtocentrydefault}%
The\ChangedAt{v3.08}{\Class{scrbook}\and \Class{scrreprt}\and
  \Class{scrartcl}} \KOMAScript{} classes don't use
\Macro{addcontentsline}\IndexCmd{addcontentsline}%
\important{\Macro{addcontentsline}} directly. Instead they
call \Macro{addtocentrydefault} with similar arguments. The command may be used
for both, entries with and without number. Thereby \PName{level} is the
textual sectioning level, i.\,e.,  \PValue{part},
\PValue{chapter}, \PValue{section}, \PValue{subsection},
\PValue{subsubsection}, \PValue{paragraph}, or \PValue{subparagraph}. The
already formatted sectioning number is given by the second argument,
\PName{number}. This argument may be empty. The text of the entry is given by
argument \PName{heading}. It is recommended to protect fragile commands inside
this argument with prefix
\Macro{protect}\IndexCmd{protect}\important{\Macro{protect}}.

There's one speciality for argument \PName{number}. An empty argument
signalizes, that an entry without number should be generated. \KOMAScript{}
uses
\begin{quote}
  \Macro{addcontentsline}\PParameter{toc}\Parameter{level}%
  \Parameter{heading}
\end{quote}
for this. Nevertheless, if the argument is not empty an entry with number
will be made and \PName{number} is the already formatted heading
number. \KOMAScript{} uses
\begin{quote}\raggedright
  \Macro{addcontentsline}\PParameter{toc}\Parameter{level}%
  \PParameter{\%\\
    \quad\Macro{protect}\Macro{numberline}\Parameter{number}%
    \PName{heading}\%\\
  }
\end{quote}
to make this.

Package authors an authors of wrapper classes may redefined this command to
manipulate the entries. For example\textnote{Example} one could suggest
\begin{lstcode}[belowskip=\dp\strutbox plus 1pt]
  \renewcommand{\addtocentrydefault}[3]{%
    \ifstr{#3}{}{%
      \ifstr{#2}{}{%
        \addcontentsline{toc}{#1}{#3}%
      }{%
        \addcontentsline{toc}{#1}{\protect\numberline{#2}#3}%
      }%
    }%
  }%
\end{lstcode}
to omit entries with empty \PName{heading}. In real live this wouldn't be
needed, because the \KOMAScript{} classes already use another method to
suppress empty entries. See the description of the structuring commands in
\autoref{sec:maincls.structure} from \autopageref{desc:maincls.cmd.part}
onward for this.%
%
\EndIndex{Cmd}{addtocentrydefault}

\begin{Declaration}
  \Macro{addparttocentry}\Parameter{number}\Parameter{heading}\\
  \Macro{addchaptertocentry}\Parameter{number}\Parameter{heading}\\
  \Macro{addsectiontocentry}\Parameter{number}\Parameter{heading}\\
  \Macro{addsubsectiontocentry}\Parameter{number}\Parameter{heading}\\
  \Macro{addsubsubsectiontocentry}\Parameter{number}\Parameter{heading}\\
  \Macro{addparagraphtocentry}\Parameter{number}\Parameter{heading}\\
  \Macro{addsubparagraphtocentry}\Parameter{number}\Parameter{heading}
\end{Declaration}%
\BeginIndex{Cmd}{addparttocentry}%
\BeginIndex{Cmd}{addchaptertocentry}%
\BeginIndex{Cmd}{addsectiontocentry}%
\BeginIndex{Cmd}{addsubsectiontocentry}%
\BeginIndex{Cmd}{addsubsubsectiontocentry}%
\BeginIndex{Cmd}{addparagraphtocentry}%
\BeginIndex{Cmd}{addsubparagraphtocentry}%
The\ChangedAt{v3.08}{\Class{scrbook}\and \Class{scrreprt}\and
  \Class{scrartcl}} \KOMAScript{} classes call the previously described
command \Macro{addtocentrydefault}\IndexCmd{addtocentrydefault}%
\important{\Macro{addtocentrydefault}} directly only if no individual command
for the \PName{level} has been defined or if that command is
\Macro{relax}\IndexCmd{relax}\important{\Macro{relax}}. Nevertheless, the
default definition of all these individual commands simply call
\Macro{addtocentrydefault} with their own \PName{level} passing their
arguments through.%
%
\EndIndex{Cmd}{addsubparagraphtocentry}%
\EndIndex{Cmd}{addsubsubsectiontocentry}%
\EndIndex{Cmd}{addparagraphtocentry}%
\EndIndex{Cmd}{addsubsectiontocentry}%
\EndIndex{Cmd}{addsectiontocentry}%
\EndIndex{Cmd}{addchaptertocentry}%
\EndIndex{Cmd}{addparttocentry}%

\begin{Declaration}
  \Macro{@fontsizefilebase}
\end{Declaration}
\BeginIndex{Cmd}{@fontsizefilebase}%
The prefix \File{scrsize} for file names of font size files, that has been
mentioned\iffree{ in \autoref{sec:maincls-experts.addInfos}}{} at
\autopageref{desc:maincls-experts.option.fontsize} is only the default of the
internal macro \Macro{@fontsizefilebase}\IndexCmd{@fontsizefilebase}. This
default is used only, if the macro hasn't already be defined when loading a
\KOMAScript{} class or package \Package{scrextend}. Authors of wrapper classes
may define this macro with another file name prefix to use completely
different font size files. Also\textnote{Hint!} authors of wrapper classes
could change or deactivate the \emph{fallback} solution for unknown font sizes
by redefinition of macro
\Macro{changefontsizes}\important{\Macro{changefontsizes}}%
\IndexCmd{changefontsize}. This macro has exactly one argument: the wanted
font size.%
%
\EndIndex{Cmd}{@fontsizefilebase}%

\begin{Declaration}
  \Macro{newkomafont}\OParameter{warning message}\Parameter{element}%
                     \Parameter{default}\\
  \Macro{aliaskomafont}\Parameter{alias name}\Parameter{element}
\end{Declaration}
\BeginIndex{Cmd}{newkomafont}%
\BeginIndex{Cmd}{aliaskomafont}%
Experts may use \Macro{newkomafont} to define a \PName{default} for the font
style of an \PName{element}. After this that default may be changed using
commands \Macro{setkomafont} and \Macro{addtokomafont} (see
\autoref{sec:maincls.textmarkup},
\autopageref{desc:maincls.cmd.setkomafont}). Of course this is not enough to
use the defined font style. The expert himself has to prepare his code to use
command
\Macro{usekomafont}\important{\Macro{usekomafont}}\IndexCmd{usekomafont} (see
\autopageref{desc:maincls.cmd.usekomafont}) with that \PName{element} at his
code definitions.

The optional argument \PName{warning message} defines a warning message,
that \KOMAScript{} will show whenever the default font style of that
\PName{element} will be changed. The sender of the warning in such cases will
be the used \KOMAScript{} class or package \Package{scrextend}.

Command \Macro{aliaskomafont} defines an \PName{alias name} to an already
defined \PName{element}. \KOMAScript{} will inform the user automatically
about the real name of the element, whenever an \PName{alias name} will be
used. An\textnote{Hint!} \PName{alias name} may be used, e.\,g., if a
developer finds a better name for an element, that has been defined formerly
with another name, if the old name should still be usable because of
compatibility. Also an \PName{alias name}s may increase usability, because
different users may find different names more or less intuitive. \KOMAScript{}
itself defines a lot of \PName{alias name}s for several \PName{element}s.
%
\EndIndex{Cmd}{aliaskomafont}%
\EndIndex{Cmd}{newkomafont}%

\begin{Declaration}
  \Macro{setparsizes}\Parameter{indent}\Parameter{distance}%^^A
  \Parameter{last line end space}
\end{Declaration}
\BeginIndex{Cmd}{setparsizes}%
With this command \KOMAScript{} provides to set the indent of the first line
of a new paragraph, the distance between paragraphs and the white space that
has to be at the end of the last line of each paragraph. This command should
be used whenever changes should also be recognized by option
\OptionValue{parskip}{relative}. \KOMAScript{}\textnote{Beispiel} itself uses
this command, e.\,g., with
\begin{lstcode}[belowskip=\dp\strutbox plus 1ex]
  \setparsizes{0pt}{0pt}{0pt plus 1fil}
\end{lstcode}
to switch of paragraph indent and distance between paragraphs and to allow any
white space at the end of the last line of paragraphs. This make sense, if a
paragraph consists of a box only, that should be printed without vertical
distance but with the whole column width. If, in opposite to that, the box
should only span the whole width but should be printed with the current
settings of paragraph indent and distance between paragraphs, usage of
\begin{lstcode}[belowskip=\dp\strutbox plus 1ex]
  \setlength{\parfillskip}{0pt plus 1fil}
\end{lstcode}
would be recommended.%
%
\EndIndex{Cmd}{setparsizes}%

\begin{Declaration}
  \Macro{raggedchapterentry}
\end{Declaration}
\BeginIndex{Cmd}{raggedchapterentry}%
This command is not really comparable with commands like
\Macro{raggedsection}. In opposite to those commands, that provide to print
corresponding elements either justified or right- or left-aligned or centered,
\Macro{raggedchapterentry} currently only provides to print chapter entries at
the table of contents justified or left-aligned. Default is justified. For
left-aligned the command has to be redefined to be
\Macro{raggedright}\important{\Macro{raggedright}}\IndexCmd{raggedright}. See
also the limitation note in \autoref{sec:maincls-experts.coexistence},
\autopageref{desc:maincls-experts.cmd.raggedsection} for this.%
%
\EndIndex{Cmd}{raggedchapterentry}

\LoadNonFree{scrbookreportarticle-experts}{3}
\begin{Declaration}
  \Macro{chapterheadstartvskip}\\
  \Macro{chapterheadendvskip}\\
  \Macro{partheadstartvskip}\\
  \Macro{partheadmidvskip}\\
  \Macro{partheadendvskip}\\
  \Macro{partheademptypage}
\end{Declaration}
\BeginIndex{Cmd}{chapterheadstartvskip}%
\BeginIndex{Cmd}{chapterheadendvskip}%
\BeginIndex{Cmd}{partheadstartvskip}%
\BeginIndex{Cmd}{partheadmidvskip}%
\BeginIndex{Cmd}{partheadendvskip}%
\BeginIndex{Cmd}{partheademptypage}%
These\important[i]{\Macro{chapter}\\
  \Macro{part}\\
  \Macro{addchap}\\
  \Macro{addpart}} are used inside of the definition of the headings
\Macro{chapter}\IndexCmd{chapter}, \Macro{part}, \Macro{addchap},
\Macro{addpart} and their star-variations. Thereby
\Macro{chapterheadstartvskip} is designed to be a command, that inserts
vertical distance before the chapter heading. Analogues
\Macro{chapterheadendvskip} is designed to be a command, that inserts vertical
distance after the chapter heading.

Vertical distance above and below part headings will be inserted using the
commands \Macro{partheadstartvskip} and \Macro{partheadendvskip}. A page break
would be interpreted to be part of the vertical distance and therefor is
already part of the default of \Macro{partheadendvskip} in
\Class{scrbook}\OnlyAt{\Class{scrbook}\and \Class{scrreprt}} and
\Class{scrreprt}. Command
\Macro{partheademptypage}\ChangedAt{v3.02}{\Class{scrbook}\and
  \Class{scrreprt}} is used to produce the empty page after the part heading
page of \Class{scrbook} and \Class{scrreprt}.

The \Class{scrbook}\OnlyAt{\Class{scrbook}\and \Class{scrreprt}} and
\Class{scrreprt} default of the six commands are listed in
\autoref{tab:maincls-experts.headvskip} and
\autoref{tab:maincls-experts.headvskip2}. The
\Class{scrartcl}\OnlyAt{\Class{scrartcl}} defaults of the three at this class
defined commands are listed in
\autoref{tab:maincls-experts.headvskip3}. An\textnote{Example!} example, that
redefines \Macro{chapterheadstartvskip} and \Macro{chapterheadendvskip} to
print extra rules above and below the chapter heading, may be found at
\cite{homepage} (in German).%
%
\begin{table}
  \centering
%  \KOMAoptions{captions=topbeside}%
%  \setcapindent{0pt}%
  \caption
%  \begin{captionbeside}
    {%
      defaults of the commands for the vertical distances of chapter headings
      with \Class{scrbook} and \Class{scrreprt}%
    }%
%    [l]
    \begin{tabular}{ll}
      \multicolumn{2}{@{}l}{\bfseries Mit \OptionValue{headings}{big}:}\\
      \toprule
      command & default definition \\
      \midrule
      \Macro{chapterheadstartvskip} &
      \Macro{vspace*}\PParameter{2.3\Macro{baselineskip}} \\
      \Macro{chapterheadendvskip} &
      \Macro{vspace*}\texttt{\{1.725\Macro{baselineskip}} \\ & \quad
      \texttt{plus .115\Macro{baselineskip}} % \\ & \quad
      \texttt{minus .192\Macro{baselineskip}\}} \\
      \bottomrule\\
      \multicolumn{2}{@{}l}{\bfseries Mit \OptionValue{headings}{normal}:}\\
      \toprule
      command & default definition \\
      \midrule
      \Macro{chapterheadstartvskip} &
      \Macro{vspace*}\PParameter{2\Macro{baselineskip}} \\
      \Macro{chapterheadendvskip} &
      \Macro{vspace*}\texttt{\{1.5\Macro{baselineskip}}\\ & \quad
      \texttt{plus .1\Macro{baselineskip}} % \\ & \quad
      \texttt{minus .167\Macro{baselineskip}\}} \\
      \bottomrule\\
      \multicolumn{2}{@{}l}{\bfseries Mit \OptionValue{headings}{small}:}\\
      \toprule
      command & default definition \\
      \midrule
      \Macro{chapterheadstartvskip} &
      \Macro{vspace*}\PParameter{1.8\Macro{baselineskip}} \\
      \Macro{chapterheadendvskip} &
      \Macro{vspace*}\texttt{\{1.35\Macro{baselineskip}}\\ & \quad
      \texttt{plus .09\Macro{baselineskip}} % \\ & \quad
      \texttt{minus .15\Macro{baselineskip}\}} \\
      \bottomrule\\
    \end{tabular}
%  \end{captionbeside}
    \label{tab:maincls-experts.headvskip}%
\end{table}
%
\begin{table}
%  \centering
  \KOMAoptions{captions=topbeside}%
  \setcapindent{0pt}%
%  \caption
  \begin{captionbeside}
    {%
      defaults of the commands for the vertical distances of part headings
      with \Class{scrbook} and \Class{scrreprt}%
    }[l]
  \begin{tabular}[t]{ll}
    \toprule
    command & default definition \\
    \midrule
    \Macro{partheadstartvskip} & \Macro{null}\Macro{vfil} \\
    \Macro{partheadmidvskip} & \Macro{par}\Macro{nobreak}\Macro{vskip} \texttt{20pt}\\
    \Macro{partheadendvskip} & \Macro{vfil}\Macro{newpage} \\
    \Macro{partheademptypage} & \Macro{if@twoside}\Macro{if@openright} \\ &
      \quad\Macro{null}\Macro{thispagestyle}\PParameter{empty}\texttt{\%}\\ &
      \quad\Macro{newpage}\\&
      \Macro{fi}\Macro{fi}\\
    \bottomrule
  \end{tabular}
  \end{captionbeside}
  \label{tab:maincls-experts.headvskip2}%
\end{table}%
%
\begin{table}
%  \centering
  \KOMAoptions{captions=topbeside}%
  \setcapindent{0pt}%
%  \caption
  \begin{captionbeside}
    {%
      defaults of the commands for the vertical distances of part headings
      with \Class{scrartcl}%
    }[l]
    \begin{tabular}[t]{ll}
      \toprule
      command & default definition \\
      \midrule
      \Macro{partheadstartvskip} & \Macro{addvspace}\PParameter{4ex} \\
      \Macro{partheadmidvskip} &  \Macro{par}\Macro{nobreak}\\
      \Macro{partheadendvskip} & \Macro{vskip} \texttt{3ex}\\
      \bottomrule
    \end{tabular}
  \end{captionbeside}
  \label{tab:maincls-experts.headvskip3}%
\end{table}%
%
\EndIndex{Cmd}{partheademptypage}%
\EndIndex{Cmd}{partheadendvskip}%
\EndIndex{Cmd}{partheadmidvskip}%
\EndIndex{Cmd}{partheadstartvskip}%
\EndIndex{Cmd}{chapterheadendvskip}%
\EndIndex{Cmd}{chapterheadstartvskip}%


\begin{Declaration}
  \Macro{appendixmore}
\end{Declaration}%
\BeginIndex{Cmd}{appendixmore}%
There is a peculiarity within the \Macro{appendix} command in the
{\KOMAScript} classes. If the command \Macro{appendixmore} is defined, this
command is executed also by the \Macro{appendix} command. Internally the
{\KOMAScript} classes \Class{scrbook}\OnlyAt{\Class{scrbook}\and
  \Class{scrreprt}} and \Class{scrreprt} take advantage of this behaviour to
implement the options \Option{appendixprefix} (see
\autoref{sec:maincls.structure},
\autopageref{desc:maincls.option.appendixprefix}). You\textnote{Attention!}
should take note of this in case you decide to define or redefine the macro
\Macro{appendixmore}. In case one of this option has been used, you will
receive an error message when using
\verb|\newcommand{\appendixmore}{|\dots\verb|}|. This behaviour is intended to
prevent you from disabling options without noticing it.

\begin{Example}
  You do not want the chapters in the main part of the classes \Class{scrbook}
  or \Class{scrreprt} to be introduced by a prefix line (see layout options
  \Option{chapterprefix} in \autoref{sec:maincls.structure},
  \autopageref{desc:maincls.option.chapterprefix}). For consistency you also
  do not want such a line in the appendix either. Instead, you would like to
  see the word ``Chapter'' in the language of your choice written in front of
  the chapter letter and, simultaneously, in the page headings.  Instead of
  using layout option \Option{appendixprefix}, you would define in the
  document preamble:
%
\begin{lstcode}
  \newcommand*{\appendixmore}{%
    \renewcommand*{\chapterformat}{%
      \appendixname~\thechapter\autodot\enskip}
    \renewcommand*{\chaptermarkformat}{%
      \appendixname~\thechapter\autodot\enskip}
  }
\end{lstcode}
%  
  In case you subsequently change your mind and decide to use the option
  \Option{appendixprefix} at a later stage, you will get an error message
  because of the already defined \Macro{appendixmore} command.  This behaviour
  prevents the definition made above from invisibly changing the settings
  intended with the option.
  
  It is also possible to get a similar behaviour of the appendix for
  the class \Class{scrartcl}. You would write in the preamble of your
  document:
\begin{lstcode}[moretexcs={ifthenelse,equal}]
  \newcommand*{\appendixmore}{%
    \renewcommand*{\othersectionlevelsformat}[3]{%
      \ifthenelse{\equal{##1}{section}}{%
        \appendixname~}{}%
      ##3\autodot\enskip}
    \renewcommand*{\sectionmarkformat}{%
      \appendixname~\thesection\autodot\enskip}}
\end{lstcode}
  In addition, the package \Package{ifthen}\IndexPackage{ifthen} (see
  \cite{package:ifthen}) is required.

  An alternative implementation would be:
\begin{lstcode}
  \newcommand*{\appendixmore}{%
    \renewcommand*{\othersectionlevelsformat}[3]{%
      \ifstr{##1}{section}{\appendixname~}{}%
      ##3\autodot\enskip}
    \renewcommand*{\sectionmarkformat}{%
      \appendixname~\thesection\autodot\enskip}}
\end{lstcode}
  Thereby used command \Macro{ifstr}\IndexCmd[indexmain]{ifstr} is provided by
  \KOMAScript{}. See \autoref{sec:scrbase.if},
  \autopageref{desc:scrbase.cmd.ifstr}.
  
  Redefined commands are explained in more detail in
  \autoref{sec:maincls.structure},
  \autopageref{desc:maincls.cmd.chapterformat} and
  \autopageref{desc:maincls.cmd.chaptermarkformat}.
\end{Example}
%
\EndIndex{Cmd}{appendixmore}%


\begin{Declaration}
  \Macro{newbibstyle}\OParameter{Elternstil}\Parameter{Name}%^^A
  \Parameter{Anweisungen}\\
  \Macro{newblock}\\
  \Macro{@openbib@code}\\
  \Macro{bib@beginhook}\\
  \Macro{bib@endhook}
\end{Declaration}
\BeginIndex{Cmd}{newbibstyle}%
\BeginIndex{Cmd}{newblock}%
\BeginIndex{Cmd}{@openbib@code}%
\BeginIndex{Cmd}{bib@beginhook}%
\BeginIndex{Cmd}{bib@endhook}%
% TODO: description
%
\EndIndex{Cmd}{bib@endhook}%
\EndIndex{Cmd}{bib@beginhook}%
\EndIndex{Cmd}{@openbib@code}%
\EndIndex{Cmd}{newblock}%
\EndIndex{Cmd}{newbibstyle}%


\section{More or Less Obsolete Options and Commands}
\label{sec:maincls-experts.obsolete}

\LoadNonFree{scrbookreportarticle-experts}{4}


\section{Out-dated, Deprecated and Obsolete Information from the Former
  \KOMAScript{} Manual\protect\footnote{This section shouldn't be here. Instead of this, all information of this
  section should be restructured and moved to the previous sections or removed
  completely. Translators from German to English would be welcome!}}
\label{sec:maincls-experts.deprecated}

\emph{Note, that the information at this section is without any structure!
  Most of the information is deprecated and maybe wrong!!!}

Since version~3.00 the main classes understand command \Macro{KOMAoptions}
(see \autoref{sec:scrlttr2.options},
\autopageref{desc:scrlttr2.cmd.KOMAoptions}).  In the course of the
development many new options were implemented and old became obsolete.  Only
the new options may be used with \Macro{KOMAoptions}.  You may find the
obsolete and corresponding new options at
\autoref{tab:maincls-experts.deprecated}.

\begin{Explain}
  In this section you will find commands which should not be used any
  longer. They are part of older {\KOMAScript} versions and their use
  was documented. For compatibility reasons they can still be used in
  the current {\KOMAScript} release. There are however new mechanisms
  and user interfaces which you should use instead. The reason for
  listing the obsolete macros in this documentation is only to aid
  users in understanding old documents.  Furthermore, package authors
  are free to use these macros in the future.

  \begin{Declaration}
    \Macro{sectfont}
  \end{Declaration}
  \BeginIndex{Cmd}{sectfont}%
  This macro sets the font which is used for all section headings and
  the abstract, the main title and the highest level below
  \Macro{part} in the table of contents. Instead, use the commands for
  the element \FontElement{disposition}, described in
  \autoref{sec:maincls.font}.%
  \EndIndex{Cmd}{sectfont}%

  \begin{Declaration}
    \Macro{capfont} \\
    \Macro{caplabelfont}
  \end{Declaration}
  \BeginIndex{Cmd}{capfont}%
  \BeginIndex{Cmd}{caplabelfont}%
  The macro \Macro{capfont} sets the font which is used for captions
  in tables and figures. The macro \Macro{caplabelfont} sets the font
  which is used for the label and numbering of tables and pictures.
  Instead, use the commands for the elements \FontElement{caption} and
  \FontElement{captionlabel}, described in
  \autoref{sec:maincls.font}.%
  \EndIndex{Cmd}{capfont}%
  \EndIndex{Cmd}{caplabelfont}%

  \begin{Declaration}
    \Macro{descfont}
  \end{Declaration}
  \BeginIndex{Cmd}{descfont}%
  This macro sets the font for the optional item arguments of a
  \Environment{description} environment. Instead, use the commands for
  the element \FontElement{descriptionlabel}, described in 
  \autoref{sec:maincls.font}.%
  \EndIndex{Cmd}{descfont}%

\end{Explain}

\begingroup
  \onelinecaptionsfalse
  \newcommand*{\NewOld}[2]{%
    \BeginIndex{Option}{#1}\PValue{#1} & \PValue{#2}\EndIndex{Option}{#1}\\
  }%
  \begin{longtable}{p{\dimexpr.5\textwidth-2\tabcolsep}p{\dimexpr.5\textwidth-2\tabcolsep}}
    \caption{Obsolete vs. Recommended Options\label{tab:maincls-experts.deprecated}}\\
    \toprule
    obsolete option & recommended option \\
    \midrule
    \endfirsthead
    \caption[]{Obsolete vs. Recommended Options
      (\emph{continuation})}\\
    \toprule
    obsolete Option & recommended option \\
    \midrule
    \endhead
    \midrule
    \multicolumn{2}{r@{}}{\dots}\\
    \endfoot
    \bottomrule
    \endlastfoot
    \NewOld{abstracton}{abstract}%
    \NewOld{abstractoff}{abstract=false}%
    \NewOld{parskip-}{parskip=full-}%
    \NewOld{parskip+}{parskip=full+}%
    \NewOld{parskip*}{parskip=full*}%
    \NewOld{halfparskip}{parskip=half}%
    \NewOld{halfparskip-}{parskip=half-}%
    \NewOld{halfparskip+}{parskip=half+}%
    \NewOld{halfparskip*}{parskip=half*}%
    \NewOld{tocleft}{toc=flat}%
    \NewOld{tocindent}{toc=graduated}%
    \NewOld{listsleft}{listof=flat}%
    \NewOld{listsindent}{listof=graduated}%
    \NewOld{cleardoubleempty}{cleardoublepage=empty}%
    \NewOld{cleardoubleplain}{cleardoublepage=plain}%
    \NewOld{cleardoublestandard}{cleardoublepage=current}%
    \NewOld{pointednumber}{numbers=enddot}%
    \NewOld{pointlessnumber}{numbers=noenddot}%
    \NewOld{nochapterprefix}{chapterprefix=false}%
    \NewOld{noappendixprefix}{appendixprefix=false}%
    \NewOld{bigheadings}{headings=big}%
    \NewOld{normalheadings}{headings=normal}%
    \NewOld{smallheadings}{headings=small}%
    \NewOld{headnosepline}{headsepline=false}%
    \NewOld{footnosepline}{footsepline=false}%
    \NewOld{liststotoc}{listof=totoc}%
    \NewOld{liststotocnumbered}{listof=numbered}%
    \NewOld{bibtotoc}{bibliography=totoc}%
    \NewOld{bibtotocnumbered}{bibliography=totocnumbered}%
    \NewOld{idxtotoc}{index=totoc}%
    \NewOld{tablecaptionabove}{captions=tableheading}%
    \NewOld{tablecaptionbelow}{captions=tablesignature}%
    \NewOld{onelinecaption}{captions=oneline}%
    \NewOld{noonelinecaption}{captions=nooneline}%
  \end{longtable}
\endgroup

\endinput

% ============================================================================
% Removed from scrbookreportarticle.tex:
% ============================================================================

\begin{Declaration}
  \OptionValue{toc}{graduated}\\
  \OptionValue{toc}{flat}
\end{Declaration}%
\BeginIndex{Option}{toc~=\PName{value}}%
\begin{Explain}
  In order to calculate automatically the space taken by the unit
  numbers when using the option \OptionValue{toc}{flat} it is necessary to
  redefine some macros. It is improbable but not impossible that this
  leads to problems when using other packages. If you think this may
  be causing problems, you should try the alternative option
  \OptionValue{toc}{graduated}, since it does not make any redefinitions. When
  using packages that affect the format of the table of contents, it
  is possible that the use of options \OptionValue{toc}{flat} and
  \OptionValue{toc}{graduated} too may lead to problems. When using such
  packages then, for safety's sake, one should refrain from using
  either of these options as global (class) options.

  If the \OptionValue{toc}{flat} option is active, the width of the field for
  unit numbering is determined when outputting the table of contents.
  After a change that affects the table of contents, at most three
  {\LaTeX} runs are necessary to obtain a correctly set table of
  contents.
\end{Explain}
\EndIndex{Option}{toc~=\PName{value}}%

\begin{Declaration}
  \Macro{tableofcontents}\\
  \Macro{contentsname}
\end{Declaration}%
\BeginIndex{Cmd}{tableofcontents}%
\BeginIndex{Cmd}{contentsname}%
\begin{Explain}
  The table of contents is set as an unnumbered chapter and is therefore
  subject to the side effects of the standard \Macro{chapter*} command,
  which are described in \autoref{sec:maincls.structure},
  \autopageref{desc:maincls.cmd.chapter*}.  However, the running
  headings\Index{running heading} for left and right pages are correctly filled
  with the heading of the table of contents. 

  The text of the heading is given by the macro
  \Macro{contentsname}. If you make use of a language package such as
  \Package{babel}, please read the documentation of that package
  before redefining this macro.
\end{Explain}%
\EndIndex{Cmd}{tableofcontents}%
\EndIndex{Cmd}{contentsname}%

There are two variants for the construction of the table of
contents. With the standard variant, the titles of the sectional units
are indented so that the unit number is flush left to the edge of the
text of the next upper sectional unit.  However, the space for the
numbers is thereby limited and is only sufficient for a little more
than 1.5 places per unit level.  Should this become a problem, the
option \OptionValue{toc}{flat} can be used to set the behaviour such that all
entries in the table of contents are set flush left under one
another. As explained in \autoref{sec:maincls.tocOptions},
\autopageref{desc:maincls.option.toc}, several {\LaTeX} runs are
needed.

{\KOMAScript} has always attempted to avoid page breaking directly
between a sectional unit and the adjacent next lower unit, for
example, between a chapter title and its first section title. However,
the mechanism worked poorly or not at all until version~2.96. In
version~2.96a\ChangedAt{v2.96a}{%
  \Class{scrbook} \and\Class{scrreprt} \and\Class{scrartcl}} the
mechanism was much improved and should now always work
correctly. There can be changes in the page breaking in the table of
contents as a result though. Thus, the new mechanism is only active,
if the compatibility option is not set to version~2.96 or less (see
option \Option{version}, \autoref{sec:maincls.compatibilityOptions},
\autopageref{desc:maincls.option.version}). The mechanism also does
not work if the commands to generate the table of contents are
redefined, for example, by the use of the package \Package{tocloft}.

\begin{Declaration}
  \Macro{ifthispageodd}\Parameter{true}\Parameter{false}
  \Macro{ifthispagewasodd} \PName{true}\Macro{else} \PName{false}\Macro{fi}
\end{Declaration}%
\BeginIndex{Cmd}{ifthispageodd}%
\BeginIndex{Cmd}{ifthispagewasodd}%
\begin{Explain}%
  A peculiarity of {\LaTeX} consists of the fact that it is not
  possible to determine on which page the current text will fall. It
  is also difficult to say whether the current page has an odd or an
  even page number. Now some will argue that there is, nevertheless,
  the {\TeX} test macro \Macro{ifodd} which one needs only to apply to
  the current page counter. However, this is an error. At the time of
  the evaluation of such a test {\LaTeX} does not know at all whether
  the text just processed will be typeset on the current page or only
  on the next. The page breaks take place not while reading the
  paragraph, but only in the \emph{output} routine of
  {\LaTeX}. However, at that moment a command of the form
  \verb|\ifodd\value{page}| would already have been completely
  evaluated.

  To find out reliably whether a text falls on an even or odd
  page, one must usually work with a label and a page reference to
  this label. One must also take special precautionary measures during
  the first {\LaTeX} run, when the label is not yet known.

  More precisely stated, the question is not where the text is, but
  whether a page reference to a label placed in this location would
  refer to an odd or an even page.

  There are situations where the \Macro{ifthispageodd} command never
  leads to the correct result. Suppose that the command is used within
  a box. A box is set by {\LaTeX} always as a whole. No page breaks
  take place inside. Assume further that the \PName{true} part is very
  big, but the \PName{false} part is empty. If we suppose further that
  the box with the \PName {false} part still fits on the current, even
  page, but that with the \PName{true} part it does not.  Further
  assume that {\KOMAScript} heuristically decides for the first run
  that the \PName{true} part applies. The decision is wrong and is
  revised in the next run. The \PName{false} part is thereby
  processed, instead of the \PName{true} part. The decision must again
  be revised in the next run and so on.

  These cases are rare. Nevertheless it should not be said that I have
  not pointed out that they are possible.

  Sometimes you need to know the state of the last decision. This may be done
  using the expert command \Macro{ifthispagewasodd}. This is either same like
  \Macro{iftrue} or \Macro{iffalse} and may be used like those.
\end{Explain}
%
\EndIndex{Cmd}{ifthispageodd}%
\EndIndex{Cmd}{ifthispagewasodd}%

\begin{Declaration}
  \Macro{chapterpagestyle}\\
  \Macro{markright}
\end{Declaration}
\BeginIndex{Cmd}{chapterpagestyle}%
\BeginIndex{Cmd}{markright}%
\begin{Explain}
  Whoever thinks that it is possible to put running headings on the
  first page of a chapter by using the command
\begin{lstcode}
  \renewcommand*{\chapterpagestyle}{headings}
\end{lstcode}
  will be surprised at the results.
  For sure, the page style \PValue{headings} is thereby applied to the
  initial page of a chapter. But nevertheless no running headings appear
  when using the \Option{openright} option.
  The reason for this behaviour can be found in the {\LaTeX}
  core. There, the command \Macro{rightmark}, that generates the marks
  for right-hand pages, is defined with;
\begin{lstcode}
  \let\@rightmark\@secondoftwo
  \def\rightmark{\expandafter\@rightmark
    \firstmark\@empty\@empty}
\end{lstcode}
  The right-hand mark is set with \Macro{firstmark}. \Macro{firstmark}
  contains the  left-hand  and right-hand  marks that were first set
  for a page. Within \Macro{chapter}, \Macro{markboth} is used to set
  the left mark to the chapter header and the right mark to empty.
  Hence, the first right
  mark on  a chapter beginning with a right-hand page is empty. Therefore,
  the running heading is also empty on those pages.

  You could redefine \Macro{rightmark} in the preamble so that the
  last mark on the page is used instead of the first:
\begin{lstcode}
  \makeatletter
  \renewcommand*{\rightmark}{%
    \expandafter\@rightmark\botmark\@empty\@empty}
  \makeatother
\end{lstcode}
  This would however cause the running heading of the first page of a
  chapter to use the title of the last section in the page. This is
  confusing and should be avoided.

  It is also confusing (and hence should be avoided) to have as
  running heading of the first page of a chapter the chapter title
  instead of the the section title. Therefore, the current behavior
  should be considered to be correct.
\end{Explain}
\EndIndex{Cmd}{markright}%
\EndIndex{Cmd}{chapterpagestyle}


\begin{Declaration}
  \Macro{the\PName{counter name}}
\end{Declaration}%
\BeginIndex{Cmd}{thecountername=the\PName{counter name}}%
As you might know, for every counter in {\LaTeX} there is a command
\Macro{the}\PName{countername}, which outputs the value of the
counter. Depending on the class the counter for a particular level
starting from \Macro{section} (\Class{book}, \Class{scrbook},
\Class{report}, \Class{scrreprt}) or \Macro{subsection}
(\Class{article}, \Class{scrartcl}) is composed of the counter for the
next higher level followed by a dot and the Arabic number of the
\PName{countername} of the respective level.\par
%
\EndIndex{Cmd}{thecountername=the\PName{counter name}}%

\subsection{Lists}
\label{sec:maincls-experts.lists} 

One concluding remark on list environments: on the internet and during support
it is often asked why such an environment is followed by a
indented\Index{indentation} paragraph. In fact, this is not the case but is
the result of the user demanding a new paragraph. In {\LaTeX} empty lines are
interpreted as a new paragraph. This is also the case before and after list
environments. Thus, if you want a list environment to be set within a
paragraph you have to omit empty lines before and after. To nevertheless
separate the environment from the rest of your text in the {\LaTeX} source
file, you can insert a comment line before and after, that is, lines which
begin with a percent character and contain nothing more.

\begin{Declaration}
  \XMacro{begin}\PParameter{\Environment{addmargin*}}%
  \OParameter{inner indentation}\Parameter{indentation}\\
  \quad\dots\\
  \XMacro{end}\PParameter{addmargin*}
\end{Declaration}
\BeginIndex{Env}{addmargin*}%
There is one problem with the \Environment{addmargin*} which you
should be aware of. If a page break occurs within an
\Environment{addmargin*} environment, the indentation on the following
page will be on the wrong side.  This means that suddenly the
\PName{inner indentation} is applied on the outside of the
page. Therefore it is recommended to prevent page breaks within this
environment. This can be achieved by using an additional
\Macro{parbox} or, as in the example above, a
\Environment{minipage}. This makes use of the fact that neither the
argument of a \Macro{parbox} nor the content of a
\Environment{minipage} breaks at the end of a page.  Unfortunately
this is not without another disadvantage: in some cases pages can no
longer be filled correctly, which has the effect of generating several
warnings.
\EndIndex{Env}{addmargin*}%

\begin{Declaration}
  \OptionValue{captions}{oneline}\\
  \OptionValue{captions}{nooneline}
\end{Declaration}
\BeginIndex{Option}{captions~=\PValue{oneline}}%
\BeginIndex{Option}{captions~=\PValue{nooneline}}%
The standard classes differentiate between one-line and multi-line
table or figure captions. One-line captions are centered while
multi-line captions are left-justified. This behavior, which is also
the default with \KOMAScript, corresponds to the option
\OptionValue{captions}{oneline}. There is no special handling of one-line
captions when the \OptionValue{captions}{nooneline} option is given.

\begin{Explain}
  The avoidance of a special treatment for the caption has an
  additional effect that is sometimes highly desirable. Footnotes that
  appear inside a \Macro{caption} command often have a wrong number
  assigned to them. This happens because the footnote counter is
  incremented once as soon as the text is measured to determine if it
  will be one line or more. When the \OptionValue{captions}{nooneline} option
  is used no such measurement is made. The footnote numbers are
  therefore correct.

  But since {\KOMAScript} version~2.9 you don't need the option
  \OptionValue{captions}{nooneline} to avoid the above described
  effect. {\KOMAScript} classes contain a workaround, so you can have
  footnotes inside captions. It should be mentioned though that when
  using footnotes inside floating environments, the contents of the
  floating environment should be encapsulated inside a minipage. That
  way it is guaranteed that floating environment and footnote are
  inseparable.
\end{Explain}
%
\EndIndex{Option}{captions~=\PValue{oneline}}%
\EndIndex{Option}{captions~=\PValue{nooneline}}%

\begin{Declaration}
  \Macro{caption}\OParameter{entry}\Parameter{title}\\
  \Macro{captionbelow}\OParameter{entry}\Parameter{title}\\
  \Macro{captionabove}\OParameter{entry}\Parameter{title}
\end{Declaration}%
\BeginIndex{Cmd}{caption}%
\BeginIndex{Cmd}{captionabove}%
\BeginIndex{Cmd}{captionbelow}%
\begin{Explain}
  Some would argue that you could achieve the same result using the
  \Macro{topcaption} command from the \Package{topcapt}
  package\IndexPackage{topcapt} (see \cite{package:topcapt}). However,
  that is not the case. The command \Macro{topcaption} is ignored by
  packages which directly redefine the \Macro{caption} macro. The
  \Package{hyperref} package (see \cite{package:hyperref}) is one such
  example. In {\KOMAScript}, \Macro{captionabove} and
  \Macro{captionbelow} are so implemented that changes have an effect
  on both of these commands as well.
  
  \phantomsection\label{desc:maincls.cmd.caption.longtable}%
  If the \Package{longtable} package\IndexPackage{longtable} is used,
  {\KOMAScript} ensures that captions above tables which are placed
  within a \Environment{longtable} environment have the same
  appearance as those in a normal \Environment{table}
  environment. This also means that you can apply the same settings as
  in a \Environment{table} environment. Please note that in the
  \Package{longtable} package the maximum width of a table caption can
  be limited and the default is set to 4\Unit{in} (see
  \cite{package:longtable}). Used together with {\KOMAScript} this
  mechanism in \Package{longtable} works only if the class option
  \Option{origlongtable} is set (see
  \autoref{sec:maincls.formattingOptions},
  \autopageref{desc:maincls.option.origlongtable}). If the
  \Package{caption2}\IndexPackage{caption2} or
  \Package{caption}\IndexPackage{caption} package (see
  \cite{package:caption}) is loaded, table captions are handled by
  this package.
  
  Please note that \Macro{captionabove} and \Macro{captionbelow}, if
  placed within a \Environment{float} environment which was defined
  using the \Package{float}\IndexPackage{float} package, have the
  exact same behaviour described in \cite{package:float} for the
  \Macro{caption} command.  In this case, the float style determines
  whether the caption will be set below or above the figure or table.
\end{Explain}
%
\EndIndex{Cmd}{caption}%
\EndIndex{Cmd}{captionabove}%
\EndIndex{Cmd}{captionbelow}%


\begin{Declaration}
  \Macro{setcapwidth}\OParameter{justification}\Parameter{width}\\
  \Macro{setcapmargin}\OParameter{margin left}\Parameter{margin}\\
  \Macro{setcapmargin*}\OParameter{margin inside}\Parameter{margin}
\end{Declaration}
\BeginIndex{Cmd}{setcapwidth}%
\BeginIndex{Cmd}{setcapmargin}%
\BeginIndex{Cmd}{setcapmargin*}%
\begin{Explain}
  \Package{longtable} places the caption in a box, which is issued
  again on subsequent pages as needed. When outputting a box, the
  macros needed for its creation are not reevaluated. That is the
  reason why it is not possible for {\KOMAScript} to swap margin
  settings for even pages in double-sided layout . This is what would
  be necessary in order to produce a justification which is shifted
  towards the outside or inside.
\end{Explain}

\begin{Example}
  A rather odd problem is that of a figure caption which is required
  to be both centered and of the same width as the figure itself. If
  the width of the figure is known in advance, the solution with
  {\KOMAScript} is quite easy. Supposing the figure has a width of
  8\Unit{cm}, it only takes:
\begin{lstcode}
  \setcapwidth[c]{8cm}
\end{lstcode}
directly in front of \Macro{caption} or \Macro{captionbelow}. If the
width is unknown then you first have to define a length in the
preamble of your document:
\begin{lstcode}
  \newlength{\FigureWidth}
\end{lstcode}
  Having done this you can calculate the width directly with the
  {\LaTeX} command \Macro{settowidth} (see \cite{latex:usrguide})
 in many cases. A possible solution would look as follows:
\begin{lstcode}
  \begin{figure}
    \centering%
    \settowidth{\FigureWidth}{%
      \fbox{\quad\KOMAScript\quad}%
      }%
    \fbox{\quad\KOMAScript\quad}%
    \setcapwidth[c]{\FigureWidth}
    \caption{Example of a centered caption below the figure}
  \end{figure}
\end{lstcode}
However, it is awkward to write the content twice and to call
\Macro{setcapwidth} for every figure. Yet nothing is easier than
defining a new command in the preamble of your document which hides
the three steps of:
  \begin{enumerate}
  \item defining the width of the argument
  \item specifying the width of the caption
  \item outputting the argument
  \end{enumerate}
  in:
\begin{lstcode}
  \newcommand{\Figure}[1]{%
    \settowidth{\FigureWidth}{#1}%
    \setcapwidth[c]{\FigureWidth}%
    #1}
\end{lstcode}
  Using this command the example abbreviates to:
\begin{lstcode}
  \begin{figure}
    \centering%
    \Figure{\fbox{\quad\KOMAScript\quad}}%
    \caption{Example of a centered caption below the figure}
  \end{figure}
\end{lstcode}
  
However, commands have the disadvantage that errors in the macros of
the argument in case of arguments with more than one line are not
reported with the very accurate line numbers by {\LaTeX}. Thus in some
cases the use of an environment has advantages. Then, however, the
question arises of how the width of the content of the environment can
be determined. The solution involves the \Environment{lrbox}
environment, described in \cite{latex:usrguide}:
\begin{lstcode}
  \newsavebox{\FigureBox}
  \newenvironment{FigureDefinesCaptionWidth}{%
    \begin{lrbox}{\FigureBox}%
  }{%
    \end{lrbox}%
    \global\setbox\FigureBox=\box\FigureBox%
    \aftergroup\SetFigureBox%
  }
  \newcommand{\SetFigureBox}{%
    \Figure{\usebox{\FigureBox}}}
\end{lstcode}
  This definition uses the macro \Macro{Figure} defined above.  In
  the main text you write:
\begin{lstcode}
  \begin{figure}
    \centering%
    \begin{FigureDefinesCaptionWidth}
      \fbox{\hspace{1em}\KOMAScript\hspace{1em}}
    \end{FigureDefinesCaptionWidth}
    \caption{Example of a centered caption below the figure}
  \end{figure}
\end{lstcode}
Admittedly, the environment in this example is not necessary. However,
its definition using \Macro{global} is quite tricky. Most users would
probably not be able to define such an environment without help. Thus,
as this definition can be very useful, it was introduced in the above
example.
  
Even if the \Environment{captionbeside} environment did not exist you
could nevertheless place the figure caption beside the figure in a
quite simple way. For this \Macro{SetFigureBox} from the example above
would have to be redefined first:
\begin{lstcode}
  \renewcommand{\SetFigureBox}{%
    \settowidth{\captionwidth}{\usebox{\FigureBox}}%
    \parbox[b]{\captionwidth}{\usebox{\FigureBox}}%
    \hfill%
    \addtolength{\captionwidth}{1em}%
    \addtolength{\captionwidth}{-\hsize}%
    \setlength{\captionwidth}{-\captionwidth}%
    \setcapwidth[c]{\captionwidth}%
    }
\end{lstcode}
Finally you only have to put the \Macro{caption} command in a
\Macro{parbox} too:
\begin{lstcode}
  \begin{figure}
    \centering%
    \begin{FigureSetsCaptionWidth}
      \fbox{\rule{0pt}{5\baselineskip}%
        \hspace{1em}\KOMAScript\hspace{1em}}
    \end{FigureSetsCaptionWidth}
    \parbox[b]{\FigureWidth}{%
      \caption{Example of a centered caption
               below the figure}
    }
  \end{figure}
\end{lstcode}
The \Macro{rule} command in this example only serves as an invisible
support to produce an example figure with a greater vertical height.
\end{Example}
%
\EndIndex{Cmd}{setcapwidth}%
\EndIndex{Cmd}{setcapmargin}%
\EndIndex{Cmd}{setcapmargin*}%

\begin{Declaration}
  \Option{origlongtable}
\end{Declaration}%
\BeginIndex{Option}{origlongtable}%
\BeginIndex{Package}{longtable}%
The package\OnlyAt{\Package{longtable}}
\Package{longtable}\IndexPackage{longtable} (see \cite{package:longtable})
sets table captions internally by calling the command \Macro{LT@makecaption}.
In order to ensure that these table captions match the ones used with normal
tables, the {\KOMAScript} classes normally redefine that command. See
\autoref{sec:maincls.floats}, \autopageref{desc:maincls.cmd.caption.longtable}
for more details. The redefinition is performed with help of the command
\Macro{AfterPackage} immediately after the loading of package
\Package{longtable}.  If the package \Package{caption2}\IndexPackage{caption2}
(see \cite{package:caption}) has been previously loaded, the redefinition is
not made in order not to interfere with the \Package{caption2} package.
%
\EndIndex{Package}{longtable}%
\EndIndex{Option}{origlongtable}%

\begin{Declaration}
  \Macro{listtablename}\\
  \Macro{listfigurename}
\end{Declaration}
\BeginIndex{Cmd}{listtablename}%
\BeginIndex{Cmd}{listfigurename}%
The text of the titles of this tables are stored in the macros
\Macro{listtablename} and \Macro{listfigurename}. If you use a
language package like \Package{babel} and want to redefine these
macros, you should read the documentation of the language package.
%
\EndIndex{Cmd}{listtablename}%
\EndIndex{Cmd}{listfigurename}%

\begin{Declaration}
  \Macro{marginpar}\OParameter{margin note left}\Parameter{margin note}\\
  \Macro{marginline}\Parameter{margin note}
\end{Declaration}%
\BeginIndex{Cmd}{marginpar}%
\BeginIndex{Cmd}{marginline}%
Unfortunately \Macro{marginpar} does not always work correctly in
two-sided\Index{twoside} layout. Whether a margin note will end up in the left
or right margin is already decided while evaluating the command
\Macro{marginpar}. If the output routine now shifts the margin note onto the
next page the formatting is no longer correct. This behaviour is deeply rooted
within {\LaTeX} and was therefore declared a feature by the {\LaTeX}3
team. \Macro{marginline} suffers from this ``feature'' too. The package
\Package{mparhack}\IndexPackage{mparhack} (see \cite{package:mparhack}) offers
a standard solution for this problem which naturally benefits also
\Macro{marginpar} and \Macro{marginline}.

Note that you may not use \Macro{marginpar} or \Macro{marginline} within float
environments such as tables or figures. Also, these commands will not function
in displayed math formulas.%
%
\EndIndex{Cmd}{marginpar}%
\EndIndex{Cmd}{marginline}%

\endinput

%%% Local Variables: 
%%% mode: latex
%%% mode: flyspell
%%% ispell-local-dictionary: "english"
%%% coding: us-ascii
%%% TeX-master: "../guide"
%%% End: 
